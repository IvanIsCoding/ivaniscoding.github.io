<!DOCTYPE html>
<html lang="en">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.55.6" />

    
    
    

<title>Quantum #5 - Deutsch-Jozsa (part 2) • Ivan Carvalho</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Quantum #5 - Deutsch-Jozsa (part 2)"/>
<meta name="twitter:description" content="Is there an advantage in using quantum computers?"/>

<meta property="og:title" content="Quantum #5 - Deutsch-Jozsa (part 2)" />
<meta property="og:description" content="Is there an advantage in using quantum computers?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ivaniscoding.github.io/posts/quantum5/" />
<meta property="article:published_time" content="2019-12-28T00:10:00-08:00"/>
<meta property="article:modified_time" content="2019-12-28T00:10:00-08:00"/><meta property="og:site_name" content="Ivan Carvalho" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.6a83d62c39a364f036df4db1ecd564645635d6c7fc182425cb501218fec485f5.css" integrity="sha256-aoPWLDmjZPA2302x7NVkZFY11sf8GCQly1ASGP7EhfU=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
</head>


    <body class="theme-base-0d layout-reverse">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://ivaniscoding.github.io/">Ivan Carvalho</a>
      </span>
      
      
      <p class="site__description">
        
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Ivan Carvalho</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/posts/">
						<span>Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/about/index.html">
						<span>About</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	
	
	<a href="https://github.com/ivaniscoding" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/ivan-carvalho" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    

<div class="builtwith">
Built with <a href="https://gohugo.io">Hugo</a> ❤️ <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
</div>


  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>Quantum #5 - Deutsch-Jozsa (part 2)</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Dec 28, 2019
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/quantum">QUANTUM</a>
              
          
      
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/quantum">quantum</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 7 min read
</div>


  </header>
  
  
  <div class="post">
    <p>This is the fifth post of a series of posts about Quantum Computing with <a href="https://qiskit.org/">Qiskit</a>. The area is very new and the SDK is changing constantly, but hopefully, the series can help you learn a bit about quantum and help me reinforce a couple concepts.</p>
<p>The goal of this post is to continue the discussion of the Deutsch-Jozsa algorithm, starting off where we stopped on <a href="/posts/quantum4/">part 1</a>.</p>
<h2 id="deutsch-jozsa-problem">Deutsch-Jozsa problem</h2>
<p>After having introduced the Deutsch problem, we will now introduce the Deutsch-Jozsa which is a generalization of the Deutsch problem. In particular, the Deutsch problem is the case of Deutsch-Jozsa with <span class="math inline">\(n = 1\)</span>.</p>
<p>Imagine that you have a black box that implements a function from n-bit strings (e.g. 11010) to 0 or 1, that is <span class="math inline">\(f : \{0, 1 \}^{n} \rightarrow \{0, 1\}\)</span>. It is guaranteed that <span class="math inline">\(f\)</span> is either a balanced or a constant function. You can make a query to the black box with a value <span class="math inline">\(v\)</span>, and the black box will return <span class="math inline">\(f(v)\)</span>. How many queries are needed to decide if the function is constant or balanced?</p>
<p>Just remembering definitions, a function is balanced when the number of values that have <span class="math inline">\(f(v) = 0\)</span> is equal to the number of values that have <span class="math inline">\(f(v) = 1\)</span>.</p>
<p>This time, we have way more than 4 possible functions, more precisely <span class="math inline">\(2(\binom{2^{n}}{2^{n-1}} + 1)\)</span>. Our classical strategy also needs more queries to classify the function. To deterministically determine the type of the function, we need <span class="math inline">\(O(2^{n})\)</span> queries because the worst case is when we obtain <span class="math inline">\(2^{n-1}\)</span> of 0s (or 1, it is symmetric) and still need an additional query to distinguish between balanced or constant.</p>
<p>From a perspective using classical computers, that is (deterministically) the best we can do. A question that arises is: can quantum computers do better? It can be shown that yes, they can. And the speedup is impressive.</p>
<h2 id="generalazing-the-solution-for-multiple-bits">Generalazing the solution for multiple bits</h2>
<p>We now need to try to generalize our solution from <span class="math inline">\(n = 1\)</span> to larger values of <span class="math inline">\(n\)</span>. It is worth trying the same solution but now using multiple bits, i.e. to apply a Hadamard to every qubit to generate all possible values, evaluate using the black box, and lastly apply Hadamard gates before measuring. The circuit we obtain looks like:</p>
<p><img src="/img/Quantum5/Q5C0.png" /></p>
<p>We now need to decide if the circuit provides criteria similar to the previous solution to differentiate between. It is helpful to expand the math to analyze that. After applying the Hadamard gates we have:</p>
<p><span class="math display">\[
|\psi\rangle = |00...0\rangle|0\rangle \rightarrow H^{\otimes N}|\psi\rangle \otimes (\frac{|0\rangle - |1\rangle}{\sqrt 2})
\]</span></p>
<p><span class="math display">\[
\rightarrow \frac{1}{\sqrt 2 ^ {n}}\sum_{x \in \{0, 1\}^{n}} |x\rangle \otimes (\frac{|0\rangle - |1\rangle}{\sqrt 2})
\]</span></p>
<p>We then send the input to the blackbox, that yields:</p>
<p><span class="math display">\[
\rightarrow \frac{1}{\sqrt 2 ^ {n}}\sum_{x \in \{0, 1\}^{n}} |x\rangle \otimes (\frac{|0 \oplus f(x)\rangle - |1 \oplus f(x)\rangle}{\sqrt 2})
\]</span></p>
<p><span class="math display">\[
\rightarrow \frac{1}{\sqrt 2 ^ {n}}\sum_{x \in \{0, 1\}^{n}} (-1)^{f(x)}|x\rangle \otimes (\frac{|0\rangle - |1\rangle}{\sqrt 2})
\]</span></p>
<p>Like in the last analysis, we used the identity <span class="math inline">\(|0 \oplus a \rangle - |1 \oplus a \rangle = (-1)^{a}(|0\rangle - |1\rangle)\)</span>. We also obtained a similar result: the last qubit does not change, so measuring it is useless and we will not worry about it afterwards.</p>
<p>Given that now we have a mathematical expression representing the state of the qubits, we can analyse the two possible cases before measuring.</p>
<h1 id="constant-case">Constant case</h1>
<p>If <span class="math inline">\(f\)</span> is constant, then all the <span class="math inline">\(x\)</span> in the summary before will have the same sign, which can be summarized as:</p>
<p><span class="math display">\[
|\psi\rangle = \pm \frac{1}{\sqrt 2 ^ {n}}\sum_{x \in \{0, 1\}^{n}} |x\rangle
\]</span></p>
<p>Notice that multiplying the whole expression by -1 does not affect the measurements because it is a global phase change. The state that happens on the balanced case after applying the black box is then:</p>
<p><span class="math display">\[
|\psi\rangle = (\frac{|0\rangle + |1\rangle}{\sqrt 2})^{\otimes n}
\]</span></p>
<p>Notice that when we apply the Hadamard gates before measuring, each <span class="math inline">\(\frac{|0\rangle + |1\rangle}{\sqrt 2}\)</span> becomes <span class="math inline">\(|0\rangle\)</span> and therefore the final state is <span class="math inline">\(|00...0\rangle\)</span>.</p>
<p>Hence, we are sure that if <span class="math inline">\(f\)</span> is constant then all measurements will always be 0.</p>
<h2 id="balanced-case">Balanced case</h2>
<p>We now need to analyse the other case, when there is no guarantee that all <span class="math inline">\(|x\rangle\)</span> will have the same sign. Indeed, we do not know anything about <span class="math inline">\(f\)</span> (just that the number of 0s and 1s is the same) so it is difficult to know the exact probability of an arbitrary state <span class="math inline">\(|x\rangle\)</span>.</p>
<p>One thing we know though is that <span class="math inline">\(|00...0\rangle\)</span> is always the output of the other case, i.e. the constant case. We may then ask: what is the probability that this case, the balanced case, will output <span class="math inline">\(|00...0\rangle\)</span>?</p>
<p>To analyze that we need to calculate the coefficient <span class="math inline">\(\alpha\)</span> of <span class="math inline">\(|\psi\rangle = \alpha|00...0\rangle + ...\)</span> after applying all the Hadamard gates, which can be seen as multiplying by <span class="math inline">\(H^{\otimes n}\)</span>.</p>
<p>One key property of <span class="math inline">\(H^{\otimes n}\)</span> is that the first line, the line that will give the <span class="math inline">\(\alpha\)</span> of the final <span class="math inline">\(|\psi\rangle\)</span>, has constant terms i.e. they are equal. More exactly, all terms of the first line of <span class="math inline">\(H^{\otimes n}\)</span> are <span class="math inline">\((\sqrt 2) ^ {-n}\)</span>. This fact can be shown by induction and I will just use it, not prove it.</p>
<p>Given that all terms of the first line are <span class="math inline">\((\sqrt 2) ^ {-n}\)</span>, the <span class="math inline">\(\alpha\)</span> we obtain is:</p>
<p><span class="math display">\[
\alpha = \frac{1}{\sqrt 2 ^ {n}} \frac{1}{\sqrt 2 ^ {n}} \sum_{x \in \{0, 1\}^{n}} (-1)^{f(x)}
\]</span></p>
<p>Now the fact that the function is balanced becomes crucial. Because the number of <span class="math inline">\(f(x) = 0\)</span> and <span class="math inline">\(f(x) = 1\)</span> are equal, the sum above is zero! Hence, <span class="math inline">\(\alpha\)</span> is zero and therefore there is no <span class="math inline">\(|00...0\rangle\)</span> component in the final state. Because of that, we are guaranteed that not all measurements will be 0, which means that at least one of the measurements will be 1.</p>
<p>Thus, the circuit we used provides criteria to classify <span class="math inline">\(f\)</span>:</p>
<ul>
<li>If all the measurements are 0, then <span class="math inline">\(f\)</span> is constant</li>
<li>If at least one of the measurements is 1, then <span class="math inline">\(f\)</span> is balanced</li>
</ul>
<p>The problem has been solved! The most impressive fact is that only 1 query was used, instead of <span class="math inline">\(O(2^{n})\)</span> queries. That is an exponential speedup.</p>
<h2 id="implementing-the-deutsch-jozsa-algorithm">Implementing the Deutsch-Jozsa algorithm</h2>
<p>We can verify that the Deutsch-Jozsa algorithm works using Qiskit and running an experiment: in the Jupyter notebook below, we try three cases for the black box and verify that our algorithm predicts correctly that it is balanced or constant.</p>
<script type="application/javascript" src="//gist.github.com/IvanIsCoding/e73a21c814f4288e188d4eec502c87e6.js"></script>
<h1 id="so-what">So what?</h1>
<p>You might ask: what is the point of the Deutsch-Jozsa algorithm? The algorithm solves a very artificial and useless problem. It has very little practical applications.</p>
<p>The algorithm, in my personal opinion, exemplifies the beauty of quantum computing: it provides an exponential speedup! Not only the speedup is impressive, but it is also unachievable by classical computers. It is one of the first algorithms from a yet-to-be-explored field.</p>
<p>It also exemplifies the less beautiful aspects of it. As of now, quantum computing… is useless. The Deutsch-Jozsa problem is a toy problem to show that two complexity classes for algorithms are different, and that is it. No applications. Not to mention that with Noisy Quantum Computers even running simple algorithms like Deutsch-Jozsa can have errors (qubits and gates are still not perfect).</p>
<p>However, the algorithm still has historical importance and inspired other algorithms that have more practical applications, like Shor’s algorithm for factorizing numbers. Hence, it is still important to study the problem.</p>
<h1 id="a-randomized-approach">A randomized approach</h1>
<p>In the initial discussion, we highlighted the deterministic factor. As a side note, we can have a probabilistic algorithm that solves the problem most of the time with an error rate <span class="math inline">\(\epsilon\)</span>. If <span class="math inline">\(k\)</span> queries are made to the black box, <span class="math inline">\(\epsilon = 2^{-(k - 1)}\)</span>. Because the decrease in <span class="math inline">\(\epsilon\)</span> is exponential, with a constant and small value of <span class="math inline">\(k\)</span> we can classify with great confidence. Below is Python code implementing that idea (<span class="math inline">\(f\)</span> is the function, <span class="math inline">\(n\)</span> is the number of bits and <span class="math inline">\(k\)</span> is the number of tries before we stop).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="im">from</span> random <span class="im">import</span> randint</a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">def</span> balanced_or_constant(f, n, k):</a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5">    first_guess <span class="op">=</span> f(randint(<span class="dv">0</span>, <span class="dv">2</span><span class="op">**</span>n <span class="op">-</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k<span class="dv">-1</span>):</a>
<a class="sourceLine" id="cb1-8" title="8">        guess <span class="op">=</span> f(randint(<span class="dv">0</span>, <span class="dv">2</span><span class="op">**</span>n <span class="op">-</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-9" title="9">        <span class="cf">if</span> guess <span class="op">!=</span> first_guess:</a>
<a class="sourceLine" id="cb1-10" title="10">            <span class="cf">return</span> <span class="st">&quot;balanced&quot;</span></a>
<a class="sourceLine" id="cb1-11" title="11"></a>
<a class="sourceLine" id="cb1-12" title="12">    <span class="cf">return</span> <span class="st">&quot;constant&quot;</span></a></code></pre></div>

  </div>
  


  

  
    


</article>


        </div>
        
    

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-135472875-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>


    
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
    
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
 <script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {delimiters: [
      {left: "$$", right: "$$", display: true},
      {left: "$", right: "$", display: false}]
    });
  });
</script>



    



    </body>
</html>
