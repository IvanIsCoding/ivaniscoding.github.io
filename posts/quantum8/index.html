<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.7.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Ivan Carvalho">

  
  
  
    
  
  <meta name="description" content="Factorizing numbers with quantum computers">

  
  <link rel="alternate" hreflang="en-us" href="https://ivaniscoding.github.io/posts/quantum8/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/atom-one-dark.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/atom-one-dark.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-135472875-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           document.location = url;
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target);  
  }

  gtag('js', new Date());
  gtag('config', 'UA-135472875-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hud7c04f8250daa34436c1572b3b03bb6e_328675_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hud7c04f8250daa34436c1572b3b03bb6e_328675_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://ivaniscoding.github.io/posts/quantum8/">

  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Ivan Carvalho">
  <meta property="og:url" content="https://ivaniscoding.github.io/posts/quantum8/">
  <meta property="og:title" content="Quantum #8 - Mathematics Behind Shor&#39;s Algorithm | Ivan Carvalho">
  <meta property="og:description" content="Factorizing numbers with quantum computers"><meta property="og:image" content="https://ivaniscoding.github.io/images/icon_hud7c04f8250daa34436c1572b3b03bb6e_328675_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="https://ivaniscoding.github.io/images/icon_hud7c04f8250daa34436c1572b3b03bb6e_328675_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-07-21T12:00:00-08:00">
    
    <meta property="article:modified_time" content="2020-07-21T12:00:00-08:00">
  

  



  


  


  





  <title>Quantum #8 - Mathematics Behind Shor&#39;s Algorithm | Ivan Carvalho</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  

<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Ivan Carvalho</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Ivan Carvalho</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      

      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Quantum #8 - Mathematics Behind Shor&#39;s Algorithm</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Jul 21, 2020
  </span>
  

  

  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/quantum/">Quantum</a></span>
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      <p>This is the eighth post of a series of posts about Quantum Computing with <a href="https://qiskit.org/">Qiskit</a>. The area is very new and the SDK is changing constantly, but hopefully, the series can help you learn a bit about quantum and help me reinforce a couple concepts.</p>
<p>The goal of this post is to discuss Shor’s algorithm, an algorithm that can factorize big numbers quickly. For an integer <span class="math inline">\(N\)</span>, Shor’s algorithm can find a factor of it in <span class="math inline">\(O((\log_{} N)^{3})\)</span> which is an almost exponential speedup over classical algorithms. This algorithm brought a lot of interest into building quantum computers, because if an ideal quantum computer could be built, then the widely used public-key cryptography RSA scheme could be broken.</p>
<h2 id="a-hybrid-algorithm">A hybrid algorithm</h2>
<p>Shor’s algorithm is hybrid becasuse it mixes a classical part and a quantum part. In this blog post, we will discuss the mathematics behind the classical part and assume the quantum part as a black box. Later on, we will see that the speed up from Shor’s algorithm comes from the quantum part, where it solves the order finding problem i.e. finding the smallest <span class="math inline">\(r\)</span> such that <span class="math inline">\(a^{r} \equiv 1 \pmod N\)</span> faster than classical computers.</p>
<p>Firstly, we need to define what the algorithm does. It solves the factorization problem: given an intenger <span class="math inline">\(N\)</span>, find two integers greater than one <span class="math inline">\(P\)</span> and <span class="math inline">\(Q\)</span> such that <span class="math inline">\(PQ = N\)</span>, or state that <span class="math inline">\(N\)</span> is prime.</p>
<p>Secondly, we need to define what the input of the algorithm is: it is <span class="math inline">\(N\)</span>, an odd integer that is neither a prime nor the power of a prime. These assumptions are necessary for the algorithm to work, and when they are not respected factorizing is still easy.</p>
<p>If <span class="math inline">\(N\)</span> is even, we can pick <span class="math inline">\(P = 2\)</span> and <span class="math inline">\(Q = N/2\)</span> so the even case is straightforward.</p>
<p>If <span class="math inline">\(N\)</span> is prime, we can check with primality tests such as <a href="https://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test">Miller-Rabin’s</a> for primality in a reasonable time complexity so this case is also easier than solving general factorization.</p>
<p>If <span class="math inline">\(N\)</span> is the power of a prime, we can check for every <span class="math inline">\(2 \leq k \leq \log_{3}N\)</span> if <span class="math inline">\(N^{1/k}\)</span> is an integer. If it is, then <span class="math inline">\(P = N^{1/k}\)</span> and <span class="math inline">\(Q = N^{(k-1)/k}\)</span> is a solution and the case for powers of primes is solved.</p>
<p>Let’s now analyse the case when <span class="math inline">\(N\)</span> is odd, not a prime nor the power of a prime that happens on the algorithm.</p>
<h2 id="math-concepts-behind-shors-algorithm">Math concepts behind Shor’s algorithm</h2>
<p>To understand Shor’s algorithm, first we need to review modular arithmetic. We use the <a href="https://www.khanacademy.org/computing/computer-science/cryptography/modarithmetic/a/the-quotient-remainder-theorem">quotient-remainder theorem</a> to write :</p>
<p><span class="math display">\[
a = N \cdot k + r \iff a \equiv r \pmod N \iff N \mid (a - r)
\]</span></p>
<p>Then, we need to recall that if <span class="math inline">\(a\)</span> and <span class="math inline">\(N\)</span> are coprime, i.e. <span class="math inline">\(\gcd(a, N) = 1\)</span>, there is a number <span class="math inline">\(r\)</span> such that:</p>
<p><span class="math display">\[
a^{r} \equiv 1 \pmod N
\]</span></p>
<p>Notice that the number <span class="math inline">\(r\)</span> we defined so far is not unique: for example, if we take <span class="math inline">\(t = 2r\)</span>, then we have <span class="math inline">\(a^{t} \equiv 1\)</span> as well.</p>
<p>To prove that <span class="math inline">\(r\)</span> exists, mathematicians generally use <span class="math inline">\(\phi(N)\)</span>, the <a href="https://en.wikipedia.org/wiki/Euler%27s_totient_function">Euler’s totient function</a> of <span class="math inline">\(N\)</span>. However, for Shor’s algorithm, we are not interested in an arbitrary <span class="math inline">\(r\)</span>: we want to find the smallest <span class="math inline">\(r\)</span>.</p>
<p>Why focus on the smallest <span class="math inline">\(r\)</span> if it is easy to compute <span class="math inline">\(\phi(N)\)</span>? The fact is that the smallest <span class="math inline">\(r\)</span> has a nice property that is key in our analysis. First, let’s rewrite our equation:</p>
<p><span class="math display">\[
a^{r} - 1 \equiv 0 \pmod N \iff
\]</span></p>
<p><span class="math display">\[
(a^{r/2} + 1)(a^{r/2} - 1) \equiv 0 \pmod N \iff
\]</span></p>
<p><span class="math display">\[
N \mid (a^{r/2} + 1)(a^{r/2} - 1)
\]</span></p>
<p>Here, we assumed that <span class="math inline">\(r\)</span> is even, and that will be a requirement for our algorithm to work. Notice that <span class="math inline">\(N \nmid (a^{r/2} - 1)\)</span>, because that would imply <span class="math inline">\(a^{r/2} \equiv 1\)</span> and violate our condition that <span class="math inline">\(r\)</span> was the smallest. Thus, the prime factors of <span class="math inline">\(N\)</span> are distributed among <span class="math inline">\(a^{r/2} - 1\)</span> and <span class="math inline">\(a^{r/2} + 1\)</span>.</p>
<p>There are two cases. In the first one, we’re out of luck: if <span class="math inline">\(N \mid (a^{r/2} + 1)\)</span>, then it might be that all the factors are on <span class="math inline">\(a^{r/2} + 1\)</span> and we can conclude nothing about the prime factorization of <span class="math inline">\(N\)</span>.</p>
<p>In the second case, <span class="math inline">\(N \nmid (a^{r/2} + 1)\)</span> and we can make a conclusion: because <span class="math inline">\(N\)</span> divides the product but not the numbers individually, at least one of <span class="math inline">\(\gcd(N, a^{r/2} + 1)\)</span> or <span class="math inline">\(\gcd(N, a^{r/2} - 1)\)</span> will be a non trivial factor of <span class="math inline">\(N\)</span>. Our factorization is done.</p>
<p>Thus, if finding <span class="math inline">\(r\)</span> is done quickly, we can try multiple values for <span class="math inline">\(a\)</span> until we found one that yields a factor. It can be shown that the probability that <span class="math inline">\(a\)</span> works is at least <span class="math inline">\(1/2\)</span>, so with few attempts for <span class="math inline">\(a\)</span> we will find a factor.</p>
<h2 id="algorithm-and-quantum-subroutine">Algorithm and quantum subroutine</h2>
<p>Given the math concepts behind Shor’s algorithm, we can write the pseudo-code for the algorithm. Notice that in this step we are not worrying about the implementation of other parts of the algorithm: we assume that the classical parts of <span class="math inline">\(\gcd\)</span>, primality-testing, checking if the k-th root is an integer are implemented and available for use. We also assume that the quantum subroutine for period finding is available for use. This yields the code:</p>
<pre class="{r}"><code>def shor_algorithm(N):
    &quot;&quot;&quot;Returns a pair of integers (P, Q) such that PQ = N for integer N&quot;&quot;&quot;

    if N % 2 == 0:  # even case
        return (N//2, 2)  # trivial factorization

    if is_prime(N):  # prime case
        return (N, 1)  # N is prime, factors cannot be found

    if is_power_k(N):  # prime power case
        k = find_power_k(N)  # we find a k such that N**(1/k) is an integer
        P = N**(1/k)
        Q = N//P
        return (P, Q)

    # Now we can assume that the criteria for Shor&#39;s algorithm is met

    while True:
        # Non-deterministic, we will try multiple values for a
        a = randint(2, N - 1)  # pick random a

        if gcd(a, N) != 1:  # Lucky case: a and N are not coprime!
            P = gcd(a, N)  # gcd yields a non-trivial factor
            Q = N//P
            return (P, Q)

        r = order_finding(a, N)  # quantum subroutine of the code

        if r % 2 == 0:
            continue  # r is not even, try another value for a

        P = gcd(a**(r//2) - 1, N)
        if P != 1:
            Q = N//P  # gcd yielded non trivial factor
            return (P, Q)
</code></pre>
<h2 id="implementing-shors-algorithm">Implementing Shor’s algorithm</h2>
<p>We can verify that Shor’s algorithm works using Python and running an experiment: in the Jupyter notebook below, we try to factorize some numbers. Notice that this code does not reach the optimal complexity, because order finding is done with classical computers instead of quantum computers. The code will be refined on the next blog posts.</p>
<script type="application/javascript" src="https://gist.github.com/IvanIsCoding/10911e3e057ea5817ba876ca7ec17aee.js"></script>

<h1 id="next-step">Next step</h1>
<p>The next step is to implement the quantum subroutine for period finding. To find the <span class="math inline">\(r\)</span> for <span class="math inline">\(a^{r} \equiv 1 \pmod N\)</span>, we will need to learn two new things: the Phase Estimation algorithm and the Quantum Fourier Transform.</p>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/quantum/">quantum</a>
  
</div>














  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://ivaniscoding.github.io/">Ivan Carvalho</a></h5>
      <h6 class="card-subtitle">Software Developer</h6>
      <p class="card-text">Python enthusiast, competitive programmer, quantum computing apprentice. Always looking for a challenge.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/ivan-carvalho/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/IvanIsCoding" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/posts/quantum7/">Quantum #7 - Grover</a></li>
      
      <li><a href="/posts/quantum6/">Quantum #6 - Bernstein-Vazirani</a></li>
      
      <li><a href="/posts/quantum5/">Quantum #5 - Deutsch-Jozsa (part 2)</a></li>
      
      <li><a href="/posts/quantum4/">Quantum #4 - Deutsch-Jozsa (part 1)</a></li>
      
      <li><a href="/posts/quantum3/">Quantum #3 - Superdense Coding</a></li>
      
    </ul>
  </div>
  



  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    

    
    

    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    <script src="/js/academic.min.e5c8525332f417fe3589df9a6b25b6c4.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
